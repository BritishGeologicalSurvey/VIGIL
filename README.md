# APVGDM
Automatic Probabilistic Volcanic Gas Dispersion Modelling
The package contains the following files:
- weather.py
Python script that prepares the weather data needed by Diagno to compute the wind field for DISGAS. 
The weather data can be either retrieved from ECMWF ERA5 database or from time series of data from weather stations that are stored in files in the working folder.
	+ ERA5 Reanalysis data
	In this mode, the script is designed to randomly sample N days from a time interval defined by the user. The number of days N is also specified by the user in input. It is possible to retrieve date from one single day by setting the end date equal to the start date and the number of samples to 1
	+ Weather station data
	In this mode, the script is design to extract weather data in the time interval specified by the user from selected weather data file. The script reads the number of files, file location and name from weather_stations.txt; the file data should be stored in the folder weather_stations. Currently, the following format is assumed:
	yyyy mm dd HH MM SS H.R.(%) T-Air(°C) Irrad.(W/m2) D-Vent(°N) V-Vent(km/h) Rain(mm) P-Air(hPa) Batt.(V) T-Air2(°C).
	Only the wind direction (D-Vent) and speed (V-Vent) are used, but it is important to provide the other data fields (placing random numbers or NaN). This will be improved in the future. [GENERALIZATION NEEDED]
The following flags control the execution of weather.py:
usage: weather.py [-h] [-S START_DATE] [-E END_DATE] [-V VOLC] [-LAT LAT]
                  [-LON LON] [-EL ELEV] [-NS SAMPLES] [-ERA5 ERA5]
                  [-WST STATION]
  -h, --help            show this help message and exit
  -S START_DATE, --start_date START_DATE
                        Start date of the sampling period. Format: DD/MM/YYYY
  -E END_DATE, --end_date END_DATE
                        Start date of the sampling period. Format: DD/MM/YYYY
  -V VOLC, --volc VOLC  This is the volcano ID based on the Smithsonian
                        Institute IDs
  -LAT LAT, --lat LAT   Volcano latitude
  -LON LON, --lon LON   Volcano longitude
  -EL ELEV, --elev ELEV
                        Volcano elevation
  -NS SAMPLES, --samples SAMPLES
                        Number of days to sample
  -ERA5 ERA5, --ERA5 ERA5
                        True: Use ERA5 reanalysis. False: Do not use ERA5
                        reanalysis
  -WST STATION, --station STATION
                        True: Use weather station data. False: Do not use
                        weather station data

- hazard_fumaroles.py
[GENERALIZATION NEEDED]

- post_process.py
Python script that:
	+ reads the DISGAS outputs produced by hazard_fumaroles.py and based on the list of days simulated, which is read from the file days_list.txt generated by hazard_fumaroles.txt
	+ converts the DISGAS outputs (currently in H2O concentration) in concentration of other gas species specified by the user in input and based on the gas species properties made available by the user in the file gas_properties.csv. The converted concentrations are stored in the folder simulation_converted
	+ calculates the converted outputs at user's specified exceedance probabilities, time steps and vertical levels; these are stored in the folder output_ecdf
	+ plot the converted outputs and those at selected exceedance probabilities at user's selectd time steps and vertical levels; the plots are stored in the folder graphical_outputs.
The following flags control the execution of post_process.py:
usage: post_process.py [-h] [-P PLOT] [-PE PLOT_EX_PROB]
                       [-EX EX_PROB [EX_PROB ...]]
                       [-T TIME_STEPS [TIME_STEPS ...]]
                       [-L LEVELS [LEVELS ...]] [-D DAYS_PLOT [DAYS_PLOT ...]]
                       [-S SPECIES [SPECIES ...]]
  -h, --help            show this help message and exit
  -P PLOT, --plot PLOT  True: Produce plots of the solutions. False: Do not
                        produce plots
  -PE PLOT_EX_PROB, --plot_ex_prob PLOT_EX_PROB
                        True: Produce plots of the specified exceedance
                        probabilities. False: Do not produce plots
  -EX EX_PROB [EX_PROB ...], --ex_prob EX_PROB [EX_PROB ...]
                        List of exceedence probabilities to be used for
                        graphical output
  -T TIME_STEPS [TIME_STEPS ...], --time_steps TIME_STEPS [TIME_STEPS ...]
                        List of time steps to plot (integer >= 0). Type all to
                        plot all the time steps
  -L LEVELS [LEVELS ...], --levels LEVELS [LEVELS ...]
                        List of vertical levels (integer >= 1) to plot. Type
                        all to plot all the levels
  -D DAYS_PLOT [DAYS_PLOT ...], --days_plot DAYS_PLOT [DAYS_PLOT ...]
                        List of days to plot (YYYYMMDD). Type all to plot all
                        the days
  -S SPECIES [SPECIES ...], --species SPECIES [SPECIES ...]
                        List of gas species (e.g. CO2)


Dependencies
[include xlrd and pandas to those already listed]